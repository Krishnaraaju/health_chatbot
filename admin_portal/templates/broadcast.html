{% extends "base.html" %}

{% block content %}
<h1 class="section-title" style="font-size: 1.8rem; margin-bottom: 1.5rem;">üö® Emergency Broadcast System</h1>
<p style="margin-bottom: 2rem; color: #636e72;">Send real-time alerts to all active chatbot users. Use for disease
    outbreaks or urgent health advisories.</p>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">

    <!-- New Alert Form -->
    <div class="stat-card">
        <h3 style="margin-bottom: 20px; color: #d63031;">Create New Alert</h3>
        <form method="POST">
            <input type="hidden" name="action" value="create">

            <div class="form-group">
                <label>Alert Title</label>
                <input type="text" name="title" class="form-input" placeholder="e.g., Dengue Outbreak in District A"
                    required>
            </div>

            <div class="form-group">
                <label>Severity Level</label>
                <select name="severity" class="form-input">
                    <option value="info">‚ÑπÔ∏è Informational</option>
                    <option value="warning">‚ö†Ô∏è Warning</option>
                    <option value="critical">üö® Critical Emergency</option>
                </select>
            </div>

            <div class="form-group">
                <label>Message Content</label>
                <textarea name="message" class="form-input" rows="4" placeholder="Detailed instructions for citizens..."
                    required></textarea>
            </div>

            <button type="submit" class="btn-primary" style="background: #d63031;">Broadcast Alert</button>
        </form>
    </div>

    <!-- Active Alerts List -->
    <div>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 class="section-title" style="margin: 0;">Active Broadcasts</h3>
            <form method="POST" onsubmit="return confirm('Clear ALL active alerts?');">
                <input type="hidden" name="action" value="clear">
                <button type="submit"
                    style="background: #b2bec3; border: none; padding: 5px 10px; border-radius: 4px; color: white; cursor: pointer;">Clear
                    All</button>
            </form>
        </div>

        {% if alerts %}
        {% for alert in alerts %}
        <div class="stat-card"
            style="margin-bottom: 15px; border-top-width: 4px; border-color: {% if alert.severity == 'critical' %}#d63031{% elif alert.severity == 'warning' %}#fdcb6e{% else %}#0984E3{% endif %};">
            <div style="display: flex; justify-content: space-between;">
                <strong>{{ alert.title }}</strong>
                <span style="font-size: 0.8rem; color: #aaa;">{{ alert.date }}</span>
            </div>
            <p style="margin-top: 10px; font-size: 0.9rem; color: #2d3436;">{{ alert.message }}</p>
            <div
                style="margin-top: 10px; font-size: 0.8rem; font-weight: bold; text-transform: uppercase; color: #636e72;">
                Severity: {{ alert.severity }}
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div style="padding: 20px; background: #fff; border-radius: 8px; text-align: center; color: #aaa;">
            No active alerts. System is normal.
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}